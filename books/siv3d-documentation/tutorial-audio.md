---
title: "チュートリアル 19 | オーディオ再生"
free: true
---

# 19. オーディオ再生
この章では、効果音や音楽の再生を制御する方法を学びます。

## 19.1 音声ファイルの読み込みと再生
オーディオを再生したいときは `Audio` を作成し、`.play()` で再生します。再生中のオーディオに `.play()` をしても何も起こりません。同じオーディオを重ねて再生したい場合は、この章の後半に出てくる `.playOneShot()` を使います。

音声ファイルから `Audio` を作成するには、`Audio` のコンストラクタ引数に、読み込みたい音声ファイルのパスを渡します。このファイルパスは、実行ファイルがあるフォルダ（開発中は `App` フォルダ）を基準とする相対パスか、絶対パスを使用します。リリース用のアプリを作るときには、のちの章で説明する「リソース」パスの使用を推奨します。

`Texture` や `Font` と同じように、`Audio` の作成にはメモリ確保などの実行時負荷がかかります。メインループの中で毎フレーム新しい `Audio` を作成するのは避け、作成が 1 回だけで済むようにしましょう。

```cpp
# include <Siv3D.hpp>

void Main()
{
	// 音声ファイルを読み込んで Audio を作成
	const Audio audio{ U"example/test.mp3" };

	// オーディオを再生
	audio.play();

	while (System::Update())
	{

	}
}
```

### 対応している音声フォーマット
OpenSiv3D v0.6.0 では、次のような音声フォーマットの読み込みがサポートされています。一部の音声フォーマットは OS によって対応状況が異なります。

| フォーマット    | 拡張子                | Windows | macOS | Linux | Web |
|-----------|--------------------|:-------:|:-----:|:-----:|:---:|
| WAVE      | .wav               | ✔       | ✔     | ✔     | ✔   |
| MP3       | .mp3               | ✔       | ✔     | ✔     | ✔*  |
| AAC       | .m4a               | ✔       | ✔     | ✔     | ✔*  |
| OggVorbis | .ogg               | ✔       | ✔     | ✔     | ✔   |
| Opus      | .opus              | ✔       | ✔     | ✔     | ✔   |
| MIDI      | .mid               | ✔       | ✔     | ✔     | ✔   |
| WMA       | .wma               | ✔       |       |       |     |
| FLAC      | .flac              | ✔       | ✔     |       |     |
| AIFF      | .aif, .aiff, .aifc |         | ✔     |       |     |

(*) ビルドオプションの設定と、特別な関数の使用が必要です。


## 19.2 ストリーミング再生
WAVE, MP3, OggVorbis, FLAC 形式の音声ファイルはストリーミング再生に対応しています。ストリーミング再生とは、最初にファイル内容の全部を読み込むのではなく、一部だけを読み込んでオーディオを再生しながら、続く部分を逐次読み込む方式のことです。メモリの使用量やファイルのロード時間が大幅に改善されます。

`Audio` でストリーミング再生を有効にするには、`Audio` のコンストラクタに `Audio::Stream` を渡してストリーミング再生をリクエストします。もし `Audio::Stream` を指定したファイルがストリーミング再生をサポートしていなかった場合は、自動的に通常の読み込みが行われます。ある `Audio` でストリーミング再生が有効になっているかは、`.isStreaming()` で調べられます。

ストリーミング再生では
- オーディオ全体の音声波形にアクセスできない
- FFT のサンプル数が少なくなる

といった、音声波形処理を行う上での一部制約が生じますが、通常のオーディオ再生用途では問題になりません。

```cpp
# include <Siv3D.hpp>

void Main()
{
	// 音声ファイルを読み込んで Audio を作成（ストリーミング再生をリクエスト）
	const Audio audio{ Audio::Stream, U"example/test.mp3" };

    // ストリーミング再生になるかを取得
	Print << audio.isStreaming();

	// オーディオを再生
	audio.play();

	while (System::Update())
	{

	}
}
```


## 19.3 一時停止と停止

```cpp

```


## 19.4 音量を変える

```cpp

```


## 19.5 音量を徐々に変える

```cpp

```


## 19.6 再生スピードを変える

```cpp

```


## 19.7 パンを変える

```cpp

```


## 19.8 再生位置を取得する

```cpp

```


## 19.9 再生位置を変更する

```cpp

```


## 19.10 ループ再生する

```cpp

```


## 19.11 範囲を指定してループ再生する

```cpp

```


## 19.12 楽器の音を生成する

```cpp

```


## 19.13 同じオーディオを重ねて再生する

```cpp

```


## 19.14 バスとグローバルオーディオの設定

```cpp

```


## 19.15 オーディオフィルタ

```cpp

```


## 19.16 空のオーディオ

```cpp

```


## 19.17 オーディオの代入

```cpp

```

